Hello, in this video we're going to talk about the specifics and syntax of visualizing data with the ggplot2 package and we're going to do so using data on penguins! 

>>

A quick reminder that ggplot2 is tidyverse's data visualization package

>> The structure of ggplot2 code looks almost always is the same: 
>> we start with the ggplot function 
>> where the first argument is the data that you want to plot
>> and the second argument defines the aesthetic mappings using the aes function -- in this template we have only defined the x and y aesthetics, for example
>> and then we add on another layer -- a geom later -- which defines the geometric shapes with which you want to represent your data 
>> and then optionally, though in many cases are recommendedly, we add further layers to the plot to make our plot a little bit easier to read, a little bit easier to glean information from.

>>

The data that we're working with is called palmer penguin so this data set contains data on measurements for penguin species uh island and palmer archipelago we have information on size related attributes like flipper length body mass build dimensions and also the sex of the penguins so if i glimpse at this data set which comes from the palmer penguins package and the data set itself is called penguins i have 344 rows that's how many penguins i have information on and seven columns and these columns are things like species island bill length measured in millimeters and build depth measured in millimeters and in the little illustration there you can see uh what each of these men means we also have their flipper length also measured in millimeters uh their body mass measured in grams and also the sex of the penguin um here is uh one visualization from these data on the x-axis i have the build depth and on the y-axis i have the bill length and i have also colored the points based on the species of the penguin so let's take a look at the code associated with it once again i have the data at the data argument is the data frame that i'm working with and the second argument is the mapping argument where i do my aesthetic mappings and so in addition to x and y variables here i have a new aesthetic mapping which is the color which says the color of my point should be the species then i tell ggplot what sort of geometric object i want to represent these points by and then i also have some labels for things like title subtitle x and y axes and also the legend as well and i also have a warning which says that two rows containing missing values have been removed and what that means is that for two of the penguins i didn't have all of the information i need so either i had build depth bill length or color or some combination of them are all of them missing for two of the penguins so they haven't been represented in my visualization once again i'm going to suppress that warning for the rest of the video but it's something important to take a note of as you're starting to do visualizations with these data so next what we're going to do is a little bit of coding out loud we're going to build the ggplot in the layers that we've talked about previously but also think about how would we say the the code in words so i start with the penguins data frame as usual i start with the ggplot function and then i say the data is equal to the uh the name of the data frame so we start with the penguins data frame which basically lays out an empty canvas for us it's almost like i could put on my beret and start painting on it next then i map build depth to the x-axis so now i can see that the um kind of the scale of this uh variable is represented on the x-axis i have some sense of what the roughly the minimum and maximum for the observations here should be and then i map bill length to the y-axis so i can see something similar happening in the y-axis this time then i represent each observation with a point so now we can finally see our observations being represented on our visualization and this is now starting to look like a data visualization then i color these points by the species of the penguin and we can see that there are three species represented adelie chinstrap and gen2 and soon as i bring in this color aesthetic gigi platoon gives me a legend for free as well which is really nice because otherwise i would have no idea what these various colors actually map to then i title the plot build depth and length and then i add a subtitle dimensions for atlea chin strap and gentoo penguins and then i label the x and y axes are as bill depth and then indicate the units of measurement millimeters and bill length and millimeters respectively and i label the legend species i just made that by default it was grabbing the name of the variable which was lowercase so to match all the other labels i made that start with an uppercase s as well then i add a caption for the data source so this is another label that i can add so i say the sources palmer station alter and i also note the the package where the data came from and finally i might choose to use a different color scheme so here i'm going to use a discrete color uh scale that is designed to be perceived by viewers with common forms of color blindness it's called the viridis scale and the function i'm using for that is scale color varidis and then underscore d and that underscore d basically says that this is a um discrete scale that i'm using and depending on the number of levels you have here i had three levels for my species variable it picked some colors that are both visually pleasing and also colorblind friendly as well so here is the ultimate plot that we made here is the code that we built and remember that here i'm showing you the warning as well and here's a narrative that we talked about start with the penguins data frame map build depth and x-axis to the x-axis and map bill length to the y-axis then we represent each observation with a point and map species to the color of each point we title the plot build depth and length and add the subtitle dimensions for adelaide chinstrap and gen 2 penguins we label the x and y axes as build depth in millimeters and build length in millimeters respectively and label the legend species and add a caption for the data source and finally we use a discrete color scale that is designed to be perceived by viewers with common forms of color blindness and so it's really i think useful as you're writing the code to think about the narrative that goes along with it not only is it going to make it easier for you to learn the syntax but it's also going to give you an understanding of how we build these plots layer by layer

a note about r in general but also about ggplot2 specifically as well is that we can actually emit the names of the first two arguments when building plots with ggplot so instead of saying data equals penguins i could just say penguins and instead of saying mapping equals the result of these aesthetic mappings coming from the aes function i could simply omit that mapping equals and start with aes so the code that you're probably going to run into a lot more regularly in the wild looks something like this where we are emitting the first two argument names um and you're going to see more of that in the course videos as well since uh real estate is precious on the slides um i'll probably try to minimize and omit explicitly mentioning the argument names so let's talk a little bit about aesthetic mappings commonly used characteristics of plotting characters that can be mapped to a specific variable in the data are color shape size and alpha which is a measurement of the transparency level of your points so here for example we have colored the points by the species of the penguins and here what i've done is added another aesthetic mapping where i said shape equals island so i'm mapping the shape to a different variable then color and so you can see that in the visualization that some of the points are represented in circles those are the penguins from biscoe island some of them are represented in triangles those are the penguins from the dream island and some of them are squares and those are the penguins from the torgerson island i could also map uh the same variable to various aesthetics so here i've actually mapped the species variable to both color and shape and now you can see that ggplot2 has uh nicely for us collapse the um the legends so that they're represented in a single legend where purple circle means adelie uh green triangles mean chin strap and yellow squares mean gen to the species this might seem redundant but it's actually good practice to not only use color for mappings but one other thing as well we've talked about color blindness being an issue so how you perceive color might be different than how someone in your audience perceives color so indicating color to communicate very important information might sometimes backfire but also if you're ever printing stuff out which um you know more and more so we're not doing that but if you are printing stuff out you and especially if you're going to be printing things out black and white it might not be a great idea to count on the grayscale mappings of anything that you're printing but instead represent that same information with the shape as well so imagine if all of these were just black points but they had the different shapes i could still tell the difference between the species versus if i had the first visualization where i only mapped species to color and i had printed this black and white in a way that the gray scale didn't work out well and i had all of the points uh black then i wouldn't be able to tell the difference between the various species another aesthetic is size so here what i've done is i have sized the points based on the body mass of the penguin so ggplot2 added a knowledge in for me again here where it says that the smallest of the scale is 3 000 grams and the largest is 6 000 grams it's a little bit hard to tell the difference between the various points but you can see that some of the penguins with really small bill length and build depth also tend to be smaller in body mass versus on the higher end of bill length and uh bell depth on the top quadrant of the visualization we all generally seem to have larger penguins by body mass as well and another aesthetic is the alpha level so here i've mapped alpha level to flipper length so the more faint the points the smaller the flipper length and the more kind of darker more opaque the points um the larger the flipper length here um i want to make a distinction between the word mapping that i've been using and then also setting certain attributes for your visualization um on the mapping side what i've done is i have mapped body mass to the size of the points and i have also mapped flipper length to the alpha level of the points so we can see that we end up getting a legend for both of these variables and these legends basically tell me depending on what i'm seeing uh what the various um kind of levels of opaqueness and also what the sizing of points actually represents so one of the things i can see here for example is that the penguins that are on the um kind of hot the top half here um or top third here um seem to have darker um mappings for flipper length so i suppose those are those tend to be bigger penguins with like longer flipper length but another thing i might want to do is actually take control of things like size and alpha but not map it to a variable so i might say i just want my points to be bigger in general so they're more visible to me or i might say i want the alpha level to be set to something um like 0.5 so the alpha level goes from 0 to 1 0 meaning completely transparent and one meaning completely opaque and so maybe i might pick something that's in between that scale and say this way when i have overlapping points they're going to appear darker and that's what the darkness is going to tell me that there are more points in that region as opposed to the value of another variable so the way i indicate that is instead of doing an aesthetic mapping for size and alpha i can actually set size and alpha to be values that i choose and that i am in control of as opposed to some values coming from my data and i do that in the gm point layer as opposed to doing it in the aesthetic mappings layer so mapping determines the things like size alpha etc of points based on the values of a variable in the data and these go into the aes function in your general gdpot

declaration and setting determines the size alpha etc of points not based on the values of a variable in the data but just based on your whim so if you love the color pink and you want to make all of your uh points pink you would actually indicate it as a value that you set the color of the point to pink by doing this in the geom layer so in this case we've placed it in the geom point but we'll learn about other geoms soon and you can basically do this in any of the other geoms as well let's also talk a little bit about faceting so fastening is basically the practice of creating smaller plots that display different subsets of the data this is especially useful for exploring conditional relationships and also when you have large data and there's a lot of over plotting going on and you want to kind of distribute things over multiple smaller plots the penguins data we're working with is only 344 observations and actually it seems like two of those observations don't have many of the attributes we want to uh plot anyway so they keep getting dropped from our plots and 340 something is not a large number for data visualization or for anything really that we're going to be doing um so in this case we won't be using faceting specifically because we're dealing with large data but it is something to keep in mind when you are working with large data so here's a plot uh where i have basically created some facets and let's take a look at the code and then come back to the plot again i've added a new faceting layer and i'm using a function called facet grid and in this function called facet grid i am saying that species goes first and then i have this tilde and then island goes next the way i would read this is facet the plot into a grid organized by species um versus island and usually here what we are looking at is when we say species versus island is we're thinking about do i split on the species along the x-axis or the y-axis so let's take a look at the plot again and so in this plot we have the various islands represented down the columns and the various species represented down the rows and we can also see that some of these species appear in all of the islands so the adeley species appears in all three islands but chin straps are only found in dream island and gentoos are only found in biscoe island it seems like for this particular dataset at least so there are various ways of doing the faceting so in the next few slides we're going to describe what each plot displays and think about how the code relates to the output and i want to note something quickly the plots in these next few slides don't have proper titles don't have proper access labels because we want you to figure out what's happening in the plots but you should always strive to label your plots properly so here i have the facet grid where i'm looking at species bisects and then let's look at the next one as well where i have another facet layer where i'm using facet grid to create a grid but now i have sex versus species so if i scroll back and forth between these two what you'll recognize is that as i change the order of the variables that go into the facet grid function what's changing is whether i'm doing that split along the columns or along the rows so when i say species versus sex species get split along the y-axis so into rows and then sex gets split into columns so this is row by column similar to when we looked at the dimension function and it reported to us rows first and then the columns and if i do sex by species the split of sex goes into the rows and the split of species goes into the columns i can also use a different way to create a facet which is facet wrap which is useful when you only want to facet by a single variable so here i just want to facet by species and what this wrap does is if it gets to the end of the line it will actually do a wrap and wrap around and kind of continue to list the various species for me i can get to the same result by using a facet grid but not specifying a variable to be split along the column so actually the result from doing a facet wrap where i just say wrap a facet by species or i say create a facet grid but don't split it up at all in the rows but only split it by species and the columns gives me the same answer which one you should use entirely up to you and here's another one where in the facet wrap function i can crea uh give it an additional argument and say i only want two columns of results so what it does is it wraps the visualizations around and the third species goes into the second row not sure why you would do this other than maybe you have some limited space where you want these plots to fit so in summary the facet grid is um for a two dimensional grid and we always uh do it in the order of rows by columns and if we don't want to split in one of the dimensions we can use just a dot and facet wrap is a one-dimensional ribbon wrapped according to the number of co rows and columns specified or the available plotting area so another thing we might do is actually add color as well so this is again a little bit redundant because we had already seen this split of fastening based on species and sex but if you actually want to add a little bit of color to your plot you can also use one of the variables that's already being used in your facet as a color aesthetic as well when you do this though ggplot will automatically give you the legend where earlier we said that was a good thing but now it's actually giving me redundant information i already can tell what color what um species names the colors map to because i can see that those are actually only being purples are only being represented in among the adeleys greens only in chin straps and yellows only in gen twos so i can turn off the automatic help ggplot gives me by saying turn off the color for the uh turn off the guide for the color aesthetic so the function is guides and i could use this function to customize that legend as well but i'm not going to worry about that right now all i want to say is that just don't give me a legend for the color aesthetic and then that goes away i gain a little bit of space and i get rid of redundant information that i didn't need